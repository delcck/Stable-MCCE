This document describes the Module "MCCE_to_NAMD_Chun_ver" and an examplary sample case.

#--Module: MCCE_to_NAMD_Chun_ver
This module provides submodules and related python objects to perform MCCE calculations, which are subsequently utilized to prepare NAMD-based molecular dynamics (MD) simulations.

The 2 submodules and their respective classes are:
1) Submodule 1: MCCE_to_NAMD
  Classes:
    (i)    PDBtoMSAna
    (ii)   AggMCCEResults
    (iii)  MSAnaToNAMD

2) Submodule 2: Vis_MCCE_on_VMD
  Classes:
    (i)    Vis_MCCE_on_VMD

#--Case study/example
The 1st submodule and its classes are for calling MCCE calculations and utilize the results to prepare MD simulations.
The examplary codes to perform such calculations at pH 7 for a case study on a lysozyme (PDB ID: 4lzt) are provided in:
  (1) step1_mcce_to_namd_Chun.sh; and
  (2) step2_mcce_to_namd_Chun.sh
Users can run the examplary codes by entering the 2 following commands sequentially in their command line interface (CLI) (e.g. Linux terminal).
Command 1: bash step1_mcce_to_namd_Chun.sh
Command 2: bash step2_mcce_to_namd_Chun.sh

Command 1 will execute 2 rounds of MCCE calculations at pH 7 for our input protein (PDB ID 4lzt), which is deposited under the dierctory "work_dir/4lzt".
The outputs of the nth round of calculations will be deposited at "work_dir/example_run_n".
Users are encouraged to modiy parameters in "step1_mcce_to_namd_Chun.sh" to adjust their runs.

Under executing command 1, command 2 will be executed. It will gather results generated by command 1 to perform a microstate analysis.
The results of the microstate analysis will be converted into N scripts, where N (default to be 5) is a user-specific paramter.
As an example, a choice of N = 3 will allow users to access the top 3 most thermodynamically probable microstates sampled by MCCE.
For each of these selected microstate and for each round of MCCE calculations, a script that provides codes to prepare NAMD-based MD-ready structures through VMD is generated.
These 3 VMD scripts are named as:
  (i)   MCCE_case_0_mcce_to_namd.tcl
  (ii)  MCCE_case_1_mcce_to_namd.tcl
  (iii) MCCE_case_2_mcce_to_namd.tcl
If users have VMD installed on their work place, a MD-ready structure (segmented PDB & PSF) can be generated by entering the following command in CLI:
Command: vmd -dispdev text < MCCE_case_0_mcce_to_namd.tcl
where case 0 (the most thermodynamically probable microstate) is used as an example here.

The 2nd submodule and its class are for utilizing results produced from the 2 steps above to visualize MCCE results on VMD.
An examplary code for this visualiztion effor is in:
  (1) step3_mcce_to_namd_Chun.sh
Users cadn run this examplary code by entering the below command in CLI:
Command: bash step3_mcce_to_namd_Chun.sh
The execution of the above command will generate VMD visualization scripts for the nth run of MCCE calculations under "work_dir/example_run_n".
These scripts are named as:
  (i)   vis_option_1.tcl
  (ii)  vis_option_2.tcl
  (iii) vis_option_3.tcl
  (iv)  vis_option_4.tcl
The 4 different scripts represent 4 types of different visualizations available now. 
The meaning and representations for these scripts are output when executing "step3_mcce_to_namd_Chun.sh".
